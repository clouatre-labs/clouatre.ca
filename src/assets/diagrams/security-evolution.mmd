flowchart TD
    PR[Pull Request] --> Tier{Select Tier}
    
    Tier -->|Public| T1[Tool Output Only]
    Tier -->|Private| T2[Stats + Quality Gate]
    Tier -->|Trusted| T3[Diff + Defense Prompt]
    
    T1 --> Safe[Risk-Controlled Results]
    T2 --> Safe
    T3 --> Safe
    
    classDef primary fill:#075985,stroke:#282728,stroke-width:2px,color:#fff
    classDef secondary fill:#e6e6e6,stroke:#ece9e9,stroke-width:2px,color:#282728
    classDef safe fill:#dcfce7,stroke:#16a34a,stroke-width:2px,color:#282728
    
    class Tier primary
    class T1,T2,T3 secondary
    class Safe safe
